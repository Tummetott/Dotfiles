# vim: set ft=bash:

{{ if and (eq .chezmoi.os "linux") (or
    (eq .chezmoi.osRelease.id "ubuntu")
    (eq .chezmoi.osRelease.id "pop")
    (eq .chezmoi.osRelease.id "debian")
    (eq .chezmoi.osRelease.id "kali")) }}

info 'Installing snap'
log sudo apt -y update
log sudo apt -y install snapd

{{ if and (eq .chezmoi.os "linux") (eq .chezmoi.osRelease.id "kali") }}
log sudo systemctl enable --now snapd snapd.apparmor
{{ end }}

{{ if and (eq .chezmoi.os "linux") (eq .chezmoi.osRelease.id "debian") }}
log sudo snap install core
{{ end }}

warn "The system needs a reboot in order to use snap. Run 'chezmoi apply' after reboot to continue the installation."
info 'Press any key to restart!'
read -n 1 -s -r
sudo reboot now

{{ else }}

error 'No installation instructions found for: snap'

{{ end }}
